!======================================================================!
program sucrose
!----------------------------------------------------------------------!
implicit none
!----------------------------------------------------------------------!
character (len =   4) :: fid ! For output filename
character (len = 200) :: filename ! Ouput filename
integer :: j
!----------------------------------------------------------------------!
write (*,*) 'Sucrose is running...'
!----------------------------------------------------------------------!
! Run to test convergence (Fig. 2).
! Loop over different initial sucrose fractions.
!----------------------------------------------------------------------!
do j = 1, 11
  !--------------------------------------------------------------------!
  ! Set string to convergence number.
  !--------------------------------------------------------------------!
  write (fid, '(i4)') j
  if (j > 999) then
    fid = fid
  else if (j > 99) then
    fid (1:1) = '0'
  else if (j > 9) then
    fid (1:2) = '00'
  else
    fid (1:3) = '000'
  end if
  !--------------------------------------------------------------------!
  filename = 'OUTPUT/diag_'//fid//'.txt'
  write (*,*) trim(filename)
  !--------------------------------------------------------------------!
end do ! j
!----------------------------------------------------------------------!
write (*,*) 'Sucrose has finished...'
!----------------------------------------------------------------------!
end program sucrose
!======================================================================!
